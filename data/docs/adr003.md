

# ADR-003: Separación de Mappers, Helpers y Acceso a Base de Datos

## Contexto
Beholder necesita sincronizar y transformar datos provenientes de múltiples fuentes externas (SmartOLT, ISPCube, cnMaestro).  
En las primeras versiones, la lógica de transformación, validación y acceso a la base de datos estaba mezclada en scripts monolíticos, lo que dificultaba:
- La mantenibilidad del código.  
- La incorporación de nuevos desarrolladores.  
- La reutilización de funciones comunes.  

El sistema debe ser modular y escalable, permitiendo agregar nuevas integraciones sin romper las existentes.

## Decisión
Se decidió separar la lógica en tres capas principales:
- **Mappers**: traducen datos externos (JSON/API) al modelo interno de Beholder.  
- **Helpers**: funciones utilitarias para validación, normalización y manejo de edge cases.  
- **DB Access**: módulo dedicado (`db.py`) para consultas y operaciones sobre la base de datos.  

Motivos:
- Claridad en la responsabilidad de cada módulo.  
- Facilita pruebas unitarias y debugging.  
- Permite reemplazar o extender cada capa sin afectar las demás.  
- Mejora la documentación y onboarding de nuevos desarrolladores.

## Consecuencias
**Positivas:**
- Código más legible y mantenible.  
- Escalabilidad: fácil agregar nuevos mappers para otras APIs.  
- Reducción de errores por mezcla de responsabilidades.  
- Documentación más clara (cada módulo tiene su propósito definido).  

**Negativas:**
- Mayor cantidad de archivos y estructura más compleja.  
- Requiere disciplina para mantener la separación y no mezclar lógica.  

**Mitigación:**
- Definir convenciones de nombres y carpetas (`mappers/`, `helpers/`, `db/`).  
- Documentar ejemplos de uso en cada módulo.  
- Revisar PRs con foco en mantener la separación de responsabilidades.  

