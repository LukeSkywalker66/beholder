

# ADR-004: Migración de SQLite a PostgreSQL

## Contexto
Beholder actualmente utiliza **SQLite** como motor de base de datos.  
Esta elección inicial permitió simplicidad en despliegue y prototipado rápido. Sin embargo, el crecimiento del ISP y la necesidad de manejar mayor volumen de clientes (fibra y antena), integraciones múltiples y consultas concurrentes hacen que SQLite empiece a mostrar limitaciones:
- Concurrencia reducida (un solo escritor a la vez).  
- Escalabilidad limitada para grandes datasets.  
- Falta de características avanzadas como particionamiento, materialized views y roles de seguridad.  

El roadmap del proyecto contempla expansión y mayor número de operadores, lo que requiere un motor más robusto.

## Decisión
Se decidió planificar la **migración de SQLite a PostgreSQL** como parte del roadmap de escalabilidad.  
Motivos:
- PostgreSQL ofrece mayor rendimiento y soporte para concurrencia.  
- Funcionalidades avanzadas de indexación (GIN, trigram, btree) ya alineadas con las prácticas de Beholder.  
- Mejor soporte para integraciones futuras y auditoría.  
- Comunidad amplia y soporte empresarial.  

## Consecuencias
**Positivas:**
- Escalabilidad para manejar decenas de miles de clientes y conexiones.  
- Mejor seguridad y control de acceso.  
- Posibilidad de optimizar consultas con particionamiento y materialized views.  
- Integración más sencilla con herramientas externas (BI, reporting).  

**Negativas:**
- Mayor complejidad operativa (necesidad de administrar un servidor de base de datos).  
- Migración requiere scripts de conversión y validación de datos.  
- Curva de aprendizaje para operadores y desarrolladores nuevos.  

**Mitigación:**
- Mantener acceso a datos encapsulado en `db.py` para facilitar migración.  
- Documentar esquema y relaciones en detalle.  
- Planificar migración gradual: primero staging, luego producción.  
- Capacitar al equipo en administración básica de PostgreSQL.  

